<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>10_hycol_space</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="style.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="the-hycol-color-space">The HYCOL color space</h1>
<p>HYCOL is a color space I’ve designed which represents colors as
points in a hyperbolic geometry. Specifically, a color is represented by
its luma (aka luminance, or value), and chroma (aka chromaticity), and
chroma is understood as a point of the two-dimensional hyperbolic plane,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>,
while luma lies on a half-line. HYCOL is constructed to have, to
reasonable accuracy, the following useful properties:</p>
<ul>
<li><strong>Perceptual uniformity</strong>, meaning that the perceived
color difference, or perceived total variation in a gradient, should be
proportional to the geometric distance according to the metric.</li>
<li><strong>Perceived luminance and chromaticity constancy</strong>,
meaning that colors at the same luma should be perceived as equally
luminous, and colors at the same chroma at different lumas should be
perceived as roughly different shades of the same hue and
saturation.</li>
<li><strong>Simple and highly symmetric geometry</strong>, in our case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>,
to provide clear and efficiently computable geometric formulations of
color theory concepts.</li>
</ul>
<p>I want the enforcement of these principles to only really be realized
within the sRGB gamut and for LCD screens, which is a small subset of
the full gamut of physically realizable colors, and then also only
really within the range of variation in digital displays and viewing
conditions around the sRGB standard.</p>
<p>This colorspace is assembled by using several known insights from the
literature in combination. These sources are:</p>
<ol type="1">
<li>The <strong>1976 CIELAB color space</strong>, which is an early
attempt at a perceptually uniform Euclidean color space.</li>
<li><em>Cui, G., Luo, M.R., Rigg, B., Roesler, G. and Witt, K. (2002),
Uniform colour spaces based on the DIN99 colour-difference formula.
Color Res. Appl., 27: 282-290.</em>, where a set of CIELAB variations,
<strong>DIN99x</strong>, are presented, which improve on CIELAB’s luma
uniformity and problematic hue shifts in the blue region.</li>
<li><em>Ivar Farup, “Hyperbolic geometry for colour metrics,” Opt.
Express 22, 12369-12378 (2014),</em> which evidences how the phenomenon
of hue superimportance can be properly addressed by converting the
chroma part of standard color spaces into a hyperbolic plane;
identifying the best match to the data in <strong>DIN99c</strong> with a
specific hyperbolic radius.</li>
<li><em>Fairchild, M.D. and Pirrotta, E. (1991), Predicting the
lightness of chromatic object colors using CIELAB. Color Res. Appl., 16:
385-393.</em>, which propose a functioning model for the strength of the
<strong>Helmholtz-Kohlrausch effect</strong>.</li>
</ol>
<p>It’s well known that color spaces based on addition of three
primaries, like forms of RGB (the difference with sRGB is immaterial for
the present discussion), are highly non-uniform and unsuitable for our
purposes. CIELAB, CIELUV, CIECAM02, etc. and similar do improve
considerably on these aspect as best as possible while mantaining a
Euclidean metric. However, they do not account correctly for two
phenomena that I think are very important for color perception in
digital art: <strong>hue superimportance</strong> and the
<strong>Helmholtz-Kohlrausch effect</strong>. In addition, the
inaccuracy of the metric has further negative implications in the
colorspace’s ability to perform blending and illumination changes in a
way that matches up with the expectation of an artist and a consumer of
art.</p>
<h3 id="hue-superimportance">Hue Superimportance</h3>
<p>Hue superimportance is the observation that for saturated colors
variations in hue produce a perceived variation which is greater than
expected. We can make this more precise. In the wheel below, the spokes
are all of equal length, in the sense that from grey up to the rim of
the wheel we perceive roughly the same total variation as the color
saturates. This total variation is the radius
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
of the wheel.</p>
<p><img src="assets/wheel_euclidean.png" /></p>
<p>If Euclidean geometry applied, then, the circumference itself should
have a length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">2\pi R</annotation></semantics></math>,
and we should perceive colors to be varying around at the same speed as
in the spokes, because the literal length of the Euclidean circle on our
hopefully flat screen is supposedly proportional to that variation.
Instead, if you pay close attention, you’ll see that the change is quite
a bit faster, almost twice as fast. We could draw a more accurate wheel
like this:</p>
<p><img src="assets/wheel_wavy.png" /></p>
<p>This fact, which is sometimes informally stated as “there are more
than 360° worth of hue at high saturation”, implies that the geometry of
the chroma plane is not flat, and since it’s always a super-importance
and never a sub-importance, it must have negative curvature.</p>
<h3 id="helmholtz-kohlrausch-effect">Helmholtz-Kohlrausch effect</h3>
<p>The HK effect is an odd perceptual phenomenon where certain very
saturated colors appear brighter than they actually are. For example,
the following colours in each image have all the same CIELAB luminance,
which is the same as the grey in the background:</p>
<p><img src="assets/hk_15.png" /> <img src="assets/hk_30.png" /> <img
src="assets/hk_50.png" /> <img src="assets/hk_70.png" /></p>
<p>Most existing colorspaces choose not to account for the HK effect, as
it can be unreliable, has psychological components, and is most
importantly dependent on the quality of the observed surface.</p>
<p>Some saturated colors look very luminous and “pop” off the
background, even though they are at the same brightness in physiological
terms. The HK effect is strong and consistent for digital displays, and
I found it necessary to take into account since it affects greatly the
perception of values, whose control is fundamental for illustration.
Failure to account for HK can result in less legible designs. It is
somewhat less relevant for traditional paints, in part because they can
often not achieve the same degree of purity (saturation) as some corners
of additive RGB, and in part because the surface quality of paint is
distinct from an LCD screen.</p>
<p>The HK effect increases with saturation, and it is stronger for
darker luminances (an already bright color is brightened less). Its
dependence on hue is very complicated and the subject of several
studies, but generally it’s accepted that it’s always positive -
saturation can never make a color look darker than it objectively is,
and that it’s most intense on blues, rather intense on magentas all the
way to reds, and has a narrow dip in strength around yellow, being
mostly non-existent for yellow hues.</p>
<h2 id="details-of-the-mapping">Details of the Mapping</h2>
<h3 id="chroma-to-din99c">Chroma to DIN99c</h3>
<p>Let a colour be expressed in CIELAB space as luma
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>L</mi><mo>*</mo></msup><annotation encoding="application/x-tex">L^*</annotation></semantics></math>
and chromaticity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mo>*</mo></msup><mo>,</mo><msup><mi>b</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">a^*,b^*</annotation></semantics></math>.</p>
<p>First, we convert chroma to the H99 space:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>b</mi><mo accent="true">̃</mo></mover><mo>=</mo><mn>0.94</mn><mo>⋅</mo><msup><mi>b</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">\tilde{b} = 0.94\cdot b^*</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo>=</mo><mn>23</mn><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>0.066</mn><msqrt><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mover><mi>b</mi><mo accent="true">̃</mo></mover><mn>2</mn></msup></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C_{\mathrm{99c}} = 23 \ln\left(1+0.066 \sqrt{(a^*)^2 + \tilde{b}^2}\right)</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo>=</mo><mo>atan2</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>b</mi><mo accent="true">̃</mo></mover><mi>/</mi><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_{\mathrm{99c}} = \operatorname{atan2}(\tilde{b}/a^*)</annotation></semantics></math></p>
<h3 id="helmholtz-kohlrausch-correction">Helmholtz-Kohlrausch
Correction</h3>
<p>Then, we perform correction of luminance to account for the
Helmholtz-Kohlrausch effect, using the Pirrotta-Fairchild model. This is
performed in DIN99c chroma coordinates instead of CIELAB, with minimal
impact.</p>
<p>First we compute the strength of the HK effect according to hue, with
the characteristic dip around yellow.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.116</mn><mrow><mo stretchy="true" form="prefix">|</mo><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>h</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo>−</mo><mn>90</mn><mi>°</mi></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mn>0.085</mn></mrow><annotation encoding="application/x-tex">f_1(h_\mathrm{99c}) = 0.116 \left|\sin\left(\frac{h_\mathrm{99c}-90°}{2} \right)\right| +0.085</annotation></semantics></math></p>
<p>Then we have the corrected luma:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mrow><mo>*</mo><mo>*</mo></mrow></msup><mo>=</mo><msup><mi>L</mi><mo>*</mo></msup><mo>+</mo><mi>μ</mi><mo>−</mo><mi>ν</mi><msup><mi>L</mi><mo>*</mo></msup><mspace width="0.167em"></mspace><mo>,</mo><mspace width="1.0em"></mspace><mi>μ</mi><mo>=</mo><mn>2.5</mn><mspace width="0.167em"></mspace><msub><mi>f</mi><mn>1</mn></msub><msub><mi>C</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mspace width="0.167em"></mspace><mo>,</mo><mspace width="1.0em"></mspace><mi>ν</mi><mo>=</mo><mn>0.025</mn><msub><mi>f</mi><mn>1</mn></msub><msub><mi>C</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L^{**} = L^* + \mu - \nu L^*\,,\quad \mu = 2.5\,f_1 C_{\mathrm{99c}}\,,\quad \nu = 0.025 f_1 C_{\mathrm{99c}}</annotation></semantics></math></p>
<h3 id="luma-to-din99c">Luma to DIN99c</h3>
<p>Finally, we perform the conversion to DIN99c luma, but employing the
HK-corrected luma as input.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><msub><mi>l</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo>=</mo><mn>317.65</mn><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>0.0037</mn><msup><mi>L</mi><mrow><mo>*</mo><mo>*</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">l = l_{\mathrm{99c}} = 317.65 \ln(1+0.0037 L^{**})</annotation></semantics></math></p>
<p>At this point, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><msub><mi>C</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo>,</mo><msub><mi>h</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(l,C_{\mathrm{99c}},h_{\mathrm{99c}})</annotation></semantics></math>
polar DIN99c coordinates with HK-effect correction.</p>
<h3 id="hyperbolicization">Hyperbolicization</h3>
<p>We then perform “hyperbolicization” by interpreting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><annotation encoding="application/x-tex">C_{\mathrm{99c}}</annotation></semantics></math>
as a geodesic radius in the hyperbolic plane:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><msub><mi>C</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mi>/</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">\rho = C_{\mathrm{99c}} / R</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>28.6</mn></mrow><annotation encoding="application/x-tex">R = 28.6</annotation></semantics></math>
is the radius of curvature of the chromaticity plane in units of DIN99c
chromaticity, and thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
is the geodesic distance of the colour from the pure grey (D65) of the
same luminance. Therefore, finally:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mo>tanh</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>ρ</mi><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mrow><mn mathvariant="normal">99</mn><mi mathvariant="normal">c</mi></mrow></msub><mo>+</mo><msub><mi>θ</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">w_0 = \tanh\left(\frac{\rho}{2}\right) e^{i(h_{\mathrm{99c}} + \theta_T)}</annotation></semantics></math></p>
<p>where the thermal angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>T</mi></msub><mo>=</mo><mn>40</mn><mi>°</mi></mrow><annotation encoding="application/x-tex">\theta_T = 40°</annotation></semantics></math>
is such that the warmest hue (an orange-ish red) is along the positive
real axis.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>0</mn></msub><annotation encoding="application/x-tex">w_0</annotation></semantics></math>
lies in the disk
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">|</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">|</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\vert w_0\vert &lt; 1</annotation></semantics></math>
and represents a point in the Poincaré disk model of the hyperbolic
plane. The colour space thus defined through
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(l,w)</annotation></semantics></math>
with the colour distance geometry
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ℝ</mi><mo>+</mo></msup><mo>×</mo><msup><mi>ℍ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^+\times \mathbb{H}^2</annotation></semantics></math>,
or precisely</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msup><mi>E</mi><mn>2</mn></msup><mo>=</mo><mi>d</mi><msup><mi>l</mi><mn>2</mn></msup><mo>+</mo><msup><mi>R</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mn>4</mn><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>d</mi><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">dE^2 = dl^2 + R^2\left(\frac{4|dw_0|^2}{(1-|w_0|^2)^2} \right)</annotation></semantics></math></p>
<p>is hypothesized to be perceptually uniform.</p>
<!-- ### Whitepoint temperature shift

The space is highly symmetric which makes the whitepoint arbitrary. For colours on the real axis $w_0 \in \mathbb{R}$, the temperature is $T = 2 \tanh^{-1}(w_0)$ (later we will extend the definition to all colours). We perform a shift to a warmer whitepoint as such:

$$w = \frac{\ch{\frac{T}{2}}w_0 - \sh{\frac{T}{2}}}{-\sh{\frac{T}{2}}w_0 + \ch{\frac{T}{2}}}$$

with the temperature of the warm whitepoint $N_W$ set to $T_W = 0.25$. This is an isometry, so $w$ also sees the same metric as $$w_0$$. -->
<h3 id="summary-and-gamuts">Summary and Gamuts</h3>
<p>The final
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(l,w)</annotation></semantics></math>
tuple constitute our hyperbolic model of colours. Only a small fraction
of the domain is actually occupied by a given gamut. Our interest is
specifically in the sRGB gamut. We assume the standard sRGB primary
specifications and the D65 whitepoint for conversion sRGB -&gt; CIEXYZ
-&gt; CIELAB.</p>
<p>The range of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
is from 0 (sRGB black) to 100 (sRGB white).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
lies in the unit disk, but in practice for reasonable whitepoints most
of the gamut is within
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">|</mo><mi>w</mi><mo stretchy="false" form="postfix">|</mo><mo>&lt;</mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">\vert w\vert&lt;0.75</annotation></semantics></math>.
At fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
we have a notion of <em>slice gamut</em>, which is always contained in
the <strong>projected gamut</strong>, which is the region in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>
of all possible values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
for colours in the sRGB gamut.</p>
<p>In the diagram, a few slice gamuts are displayed in the Poincaré disk
model of chroma space, bounded by the outline of the projected
gamut.</p>
<p><img src="assets/gamuts.png" /></p>
<p>The projected gamut is the shape, vaguely circular, outlined by six
smooth segments. This boundary is the image of the hexagon of the sRGB
primaries and secundaries in the order red -&gt; yellow -&gt; green
-&gt; cyan -&gt; blue -&gt; magenta -&gt; red. The images of these
segments are not themselves straight segments, and do bulge out
considerably.</p>
<p>It would be misleading to display the <em>interior</em> of the full
projected gamut all at once on the same plane, because no single value
of luma covers it all simultaneously, and variation in luminance will
affect colour difference and thus deform the metric.</p>
<h3 id="inverse-transformation">Inverse transformation</h3>
<p>The transformation CIELAB -&gt; hyperbolic model is composed of
individually invertible elements. Schematically, starting from a
hyperbolic colour in the warm frame:</p>
<ul>
<li>The radial distance is “de-hyperbolicized” and thermal angle removed
to recover DIN99c chroma.</li>
<li>HK-corrected luma is recovered from DIN99c by inverting the
mapping.</li>
<li>Uncorrected CIELAB luma is recovered by inverting the (linear)
HK-correction.</li>
<li>DIN99c chroma is easily mapped back to CIELAB chroma</li>
</ul>
<h2 id="geometry-of-hyperbolic-color">Geometry of Hyperbolic Color</h2>
<p>Below are various luma slices of the sRGB gamut in the HYCOL space,
with chroma represented in the Poincaré disk model (the disk boundary is
outside the image). The metric of the hyperbolic plane cannot be
depicted accurately, sadly, but I’ve overlaid for you a portion of the
<a
href="https://en.wikipedia.org/wiki/Order-7_triangular_tiling">Order-7
triangular tiling</a> (subdivided) - all of the edges have in fact equal
length, even though they appear to shrink away from the center.</p>
<p><img src="assets/atlas.png" /></p>
<h1 id="temperature-and-reference-frames">Temperature and Reference
Frames</h1>
<h2 id="horocyclic-temperature-rationale">Horocyclic Temperature:
Rationale</h2>
<p>I propose a notion of colour temperature alternative to the
traditional one based on the Planckian locus and more aligned with the
subjective impression of “warmth”. Temperature of individual colours,
not merely lights, is artistically relevant. Warmer colours are
perceived to be closer, moving outside the screen towards the viewer,
and more abstractly have a quality of “intimacy”; conversely, cooler
colours recede.</p>
<!-- As already said, the $w = t \in \mathbb{R}$ axis of neutrals has a natural and intuitive notion of warmth, which is signed distance alongside it from a reference white $N_0$, and thus $T_{w_0} = 2 \th^{-1}(t)$. This temperature is in completely different units and interpretation than physical temperature of a black body, spanning on the neutral axis from $T = -1.07$ (noon sky) through $T = 0.0$ at true white $N_0$ into $T=1.62$ (glowing orangeish red). Note that warmer and cooler colours than these extremes exist off-axis. -->
<p>The first assumption that I make is that temperature only depends on
chroma, not luma (if both are properly constructed). This means that the
isotherms, the sets of colors of equal temperature, are curves in the
hyperbolic chroma plane. What kind of curves? It would be preferable for
them to be a more symmetric and simple family of curves, or at least be
approximately described as such.</p>
<p>Let’s begin by identifying the “warmest hue”, which must be properly
defined to hold at any given saturation. We observe that such warmest
hue is very clearly perceived to be an orangeish-red, or
<strong>vermillion</strong>. Blood red and carrot on either side, at
equal saturation, are sharply seen to be colder. Consider the hyperbolic
line from D65 white to vermillion, extended backwards as well into sky
blue. We’ll call this the <strong>thermal axis</strong>, and HYCOL has
been defined so that this is conveniently just the horizontal line of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>∈</mo><mi>ℝ</mi></mrow><annotation encoding="application/x-tex">w \in \mathbb{R}</annotation></semantics></math>.
It would be reasonable to define the temperature for colors on the
thermal axis as the signed distance from white, and in fact we’ll see in
a bit that this is sound. If we do, then translations along the thermal
axis are just simply shifts in temperature.</p>
<p>Then isotherms must meet the thermal axis at right angle, and their
temperature is that of the point of intersection. If they are
sufficiently symmetric, so curves of constant curvature, then they are a
pencil of generalized circles orthogonal to the thermal axis.</p>
<p>The first observation to make is that the isotherms do indeed curve,
with the concavity oriented towards warmth. This is manifested in the
fact that the temperature variation with hue is much larger for warm
hues, i.e. vermillion is clearly warmer than neighbouring tones, while
cold hues tend to have a very subdued variation, with greens, teals,
blues and even purples having roughly comparable temperature. The second
piece of evidence is the expectation that classical (Planck-locus based)
isotherms in the CIEXYZ model are expected to intersect somewhere in the
magentas – hyperbolic lines perpendicular to the thermal axis could not
possibly converge, so there must be curvature.</p>
<p>If isotherm curvature is present towards warmth, then depending on
its value we have three distinct geometrical cases:</p>
<ul>
<li>If curvature &lt; 1, the isotherms are hypercycles (aka equidistant
curves) and they do eventually diverge.</li>
<li>If curvature = 1, matching precisely the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>
curvature, the isotherms are horocycles, which are infinite curves that
all meet at one point at infinity on the thermal axis, the <strong>ideal
warm point</strong>.</li>
<li>If curvature &gt; 1, then the isotherms are circles with a common
center. This center is a point on the thermal axis warmer than
vermillion and way out of the physical gamut.</li>
</ul>
<p>I find that the limiting horocyclical case is as good a match with
observations than the other two possibilities, and is more parsimonious
as it eliminates the parameter of the isotherm curvature. Let’s
therefore assume the horocyclical model for temperature.</p>
<h2 id="horocyclic-temperature-review">Horocyclic Temperature:
Review</h2>
<p>The ideal warm point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>W</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_W=1</annotation></semantics></math>
is a special point on the boundary of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>
at infinity. Horocyclic temperature is in fact just distance from this
point, properly renormalized. In particular, imagine starting from a
non-ideal warm center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>W</mi></msub><annotation encoding="application/x-tex">w_W</annotation></semantics></math>,
then define the temperature of a color
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>U</mi></msub><annotation encoding="application/x-tex">w_U</annotation></semantics></math>
as the distance from the center minus the temperature of D65 white:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>U</mi></msub><mo>=</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>U</mi></msub><mo>,</mo><msub><mi>w</mi><mi>W</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>w</mi><mi>W</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T_U = d(w_U, w_W) - d(0,w_W)</annotation></semantics></math></p>
<p>Then sending
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>W</mi></msub><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_W \rightarrow 1</annotation></semantics></math>
the temperature converges in the limit. As argued, the lines of constant
temperature, the isotherms, are horocycles, which can be seen as circles
of infinite radius centered <em>and</em> converging onto on the point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>W</mi></msub><annotation encoding="application/x-tex">w_W</annotation></semantics></math>,
which is infinitely far away. In the Poincaré disk model, the horocycles
are represented as circles tangent to the boundary at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>W</mi></msub><annotation encoding="application/x-tex">w_W</annotation></semantics></math>.</p>
<p>Here are the isotherms at different luminances, depicted as
horizontal strips. The horizontal metric is accurate.</p>
<p><img src="assets/isotherm_strips.png" /></p>
<p>Consider now curves which are orthogonal to the isotherms, which are
the curves of maximum temperature variation. These are in fact straight
lines, specifically all the lines from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>W</mi></msub><annotation encoding="application/x-tex">w_W</annotation></semantics></math>.
Since these generalize the original thermal axis through D65, we can
call all of these <strong>thermal axes</strong>, and hypothesize a sort
of “relativity” holds which maps any thermal axis to any other. Within
any thermal axis, the temperature difference between two colors is
precisely their distance (which is along the axis, since it’s a
line).</p>
<p>Being orthogonal everywhere, the isotherms and thermal axes suggest a
definition of a different set of conformal coordinates. This in fact the
half-plane model of the hyperbolic plane, detailed in the appendix. If
we define</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mo>−</mo><mi>i</mi><mfrac><mrow><mi>w</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex"> z = -i\frac{w+1}{w-1} </annotation></semantics></math></p>
<p>then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℑ</mi><mi>z</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Im z &gt; 0</annotation></semantics></math>
defines a coordinate on the chroma plane, the <strong>thermal
chart</strong>. The imaginary part of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is related to the temperature, while the real part expresses a kind of
green-violet axis:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>ℜ</mi><mi>z</mi><mo>+</mo><mi>i</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup></mrow><annotation encoding="application/x-tex">z = \Re{z} + i e^{-T}</annotation></semantics></math></p>
<p>The chart is not particularly useful for visualization purposes or
color theory, as it distorts distances even more severely than the disk
model, but it does provide the following convenient formula for the
temperature of any chroma:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mo>−</mo><mo>log</mo><mi>ℑ</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mo>−</mo><mi>i</mi><mfrac><mrow><mi>w</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mo>log</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup></mrow><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">T = - \log \Im \big(-i\frac{w+1}{w-1}\big) = - \log \frac{1-|w|^2}{|w-1|^2}</annotation></semantics></math></p>
<h2 id="reference-frames">Reference Frames</h2>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>
was chosen as a chroma plane because of its elevated degree of symmetry.
The temperature system breaks part of it; specifically the isometries
that remain are those who keep the ideal warm point fixed, which is a
two-dimensional subgroup. We will call these “boosts” for lack of a
better term.</p>
<p>Consider a chroma
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
which I want to use as a new “center”, as a whitepoint, in alternative
to D65 white which is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>.
There is precisely one boost which takes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>↦</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">c \mapsto 0</annotation></semantics></math>.
(Note: this would not have been true if the warm point was not ideal, so
the ability to change whitepoint and maintain a notion of temperature is
another advantage of the horocyclical model.) This means that every
whitepoint defines uniquely a new <strong>reference frame</strong> and
vice versa.</p>
<p>To be more explicit - when a new whitepoint is presented, it’s easy
enough to recenter our coordinates on it so that colors are now
described as relative to the new context. However, rotation around the
whitepoint is now arbitrary, meaning relative hue is defined but
absolute hue is meaningless (a disaster - we can’t tell red from blue!)
and requiring the new frame to be parallel to the original one is
impossible due to the curvature of chroma space. Instead, the frame is
aligned so that hue zero is the direction from the whitepoint to the
ideal warm pole, which is to say the thermal axis passing through it.
That direction is always the warmest hue, by definition the vermillion
relative to that whitepoint.</p>
<p>Observe that the pencil of isotherm is invariant under boosts, so
they will look the same in all reference frame - horocycles through the
ideal warm point, which is always
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>W</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_W=1</annotation></semantics></math>,
but the temperature they refer to will be shifted by the temperature of
the whitepoint itself.</p>
<h1 id="geodesic-blending-and-fields">Geodesic Blending and Fields</h1>
<p>The fundamental object that the theory is based on is the
<strong>geodesic gradient</strong>, which is the “optimal” interpolation
between two colours (the vertices), in the sense that it involves the
least possible perceived total colour variation and that such perceived
change occurs at constant speed. This is geometrically the geodesic
segment between two points, which is the shortest path and, by
necessity, of curvature zero.</p>
<p>When a geodesic gradient stretches between two vertices with
different luminance, the luminance changes at the same rate that the
chromaticity does, relative to the total. For example, when we are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">1/3</annotation></semantics></math>
of the way through from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>,
or equivalently we are performing a blend of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
with weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">2/3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">1/3</annotation></semantics></math>
respectively, the luminance will be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mrow><mi mathvariant="normal">b</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi></mrow></msub><mo>=</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msub><mi>l</mi><mi>A</mi></msub><mo>+</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>l</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">l_\mathrm{blend} = \frac{2}{3} l_A + \frac{1}{3}l_B</annotation></semantics></math>,
<em>and</em> the chromaticity will be at a distance along the path in
the same proportion:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>A</mi></msub><mo>,</mo><msub><mi>w</mi><mrow><mi mathvariant="normal">b</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>B</mi></msub><mo>,</mo><msub><mi>w</mi><mrow><mi mathvariant="normal">b</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">d(w_A,w_\mathrm{blend}) = \frac{1}{2} d(w_B,w_\mathrm{blend})</annotation></semantics></math>.
This follows from the fact that the colour metric is a product metric,
and defines uniquely the geodesic gradient between any two colours, or
equivalently the weighted blend between two colours
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
with weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>A</mi></msub><mo>,</mo><msub><mi>λ</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_A,\lambda_B</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>A</mi></msub><mo>+</mo><msub><mi>λ</mi><mi>B</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_A+\lambda_B=1</annotation></semantics></math>.</p>
<p><img src="assets/gradients.png" /></p>
<p><img src="assets/gradients_chroma.png" /></p>
<p>Visually, the HYCOL geodesic gradient introduces much less spurious
hues and it is perceived as gentler, almost inoffensive: the geodesic
gradient introduces no new colors besides the two extremes. By taking
the shortest possible path between them, it’s almost like it’s not
saying anything more than the poles themselves are. This will end up
proving a very useful characteristic for the purpose of regaining
artistic control over statements made with color - specifically, with
some caveats, it will be possible to pick freely from geodesic gradients
(and generalizations) assuming the poles themselves have been chosen
correctly, since no potentially dissonant colors will have been
accidentally introduced.</p>
<p>Because the negative curvature of chroma space makes line segments be
closer to the origin than they would be in flat space, the middle
portion of a geodesic gradient is much less saturated than expected.
Being also optimal in terms of perceptual length, the number of uniquely
distinguishable shades that interpolate is small - it looks “short”.
Finally, because HYCOL accounts for the HK effect on digital screens, it
has a very uniform and gradual luminance slope, while other blendings
can have occasional bumps and troughs in perceive brightness; the result
is a vague impression of flatness.</p>
<h2 id="computation">Computation</h2>
<p>For the computational aspect, there is a closed form expression for
such an interpolation as the hyperbolic equivalent of the SLERP
operation for spherical geometry, sometimes called HLERP. However this
is of limited use, since the generalization to a weighted blend of more
than two colours, which we do require extensively, has no closed form
solution anyway.</p>
<p>We are interested in blending several colours
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>C</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">C_1, C_2,\ldots, C_n</annotation></semantics></math>
with weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>λ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_1,\ldots, \lambda_n</annotation></semantics></math>
that sum to one:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>λ</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_i \lambda_i = 1</annotation></semantics></math>.
(We will only need
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">n=3</annotation></semantics></math>,
where HLERP is barycentric coordinates over a triangle, but no
simplification is offered compared to the general case). Of course, we
will blend lumas
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mi>i</mi></msub><annotation encoding="application/x-tex">l_i</annotation></semantics></math>
and chromas
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>i</mi></msub><annotation encoding="application/x-tex">w_i</annotation></semantics></math>
separately with the same weights. For lumas, we just perform a regular
linear interpolation. For hyperbolic chromas, defining a canonical
weighted average in an arbitrary space is generally impossible, but
there is a consistent way to do so for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>
points due to its high degree of symmetry.</p>
<p>We impose the requirement that the n-fold HLERP reduces to the
two-point geodesic HLERP when all the weights but two vanish:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>HLERP</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><mi>λ</mi><mo>;</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo>;</mo><msub><mi>w</mi><mn>3</mn></msub><mo>,</mo><mn>0</mn><mo>;</mo><msub><mi>w</mi><mn>4</mn></msub><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>HLERP</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><mi>λ</mi><mo>;</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mi>λ</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{HLERP}(w_1,\lambda;w_2,1-\lambda;w_3,0;w_4,0,\ldots) = \operatorname{HLERP}(w_1,\lambda;w_2,\lambda-1)</annotation></semantics></math></p>
<p>for triangles, for examples, this means that blends where one vertex
has weight zero reduce to the blend between the remaining two
vertices.</p>
<p>The following definition successfully generalizes the Euclidean lerp
to both spherical and hyperbolic geometry. The weighted average
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">¯</mo></mover><mo>=</mo><msub><mo>⨁</mo><mi>i</mi></msub><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\overline{w} = \bigoplus_i \lambda_i w_i</annotation></semantics></math>
is the unique point that minimizes the objective function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>λ</mi><mi>i</mi></msub><mspace width="0.167em"></mspace><mi>d</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">J(w) = \frac{1}{2}\sum_i \lambda_i \,d(w,w_i)^2</annotation></semantics></math></p>
<p>This optimization must be performed numerically for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n&gt;2</annotation></semantics></math>.
We employ a version of gradient descent, though care should be applied
to understand the nature of this gradient as a mathematical object.
First, let’s notate by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M(q)</annotation></semantics></math>
the Moebius transformation that sends
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
translating along the geodesic segment from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>,
which is explicitly</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>q</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup></mrow></msqrt></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>q</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mover><mi>q</mi><mo accent="true">¯</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M(q) = \frac{1}{\sqrt{1-|q|^2}}\begin{pmatrix}1 &amp; q \\\overline{q} &amp; 1\end{pmatrix}</annotation></semantics></math></p>
<p>This matrix embodies the notion of translating in the direction and
distance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
“in the simplest way possible”, considering the difficulty of being
unable to compare directions at different points.</p>
<p>We can then define the positions of the vertices relative to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
by performing the inverse transformation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>=</mo><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i = M(-w) \cdot w_i</annotation></semantics></math></p>
<p>Of course,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">d(r_i,0)=d(w_i,w)</annotation></semantics></math>.
Then, we can define the “logarithm” of such relative position as a
complex number with the same phase and norm equal to the distance:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><msub><mi>ϕ</mi><mi>i</mi></msub></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><msub><mi>ϕ</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\log[r_i] = \log \left[|r_i|e^{i\phi_i}\right] = d(r_i,0) e^{i\phi_i}</annotation></semantics></math></p>
<p>The logarithm is a tangent vector which belongs to the tangent space
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℍ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb{H}^2</annotation></semantics></math>
at the origin, which is just
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℂ</mi><annotation encoding="application/x-tex">\mathbb{C}</annotation></semantics></math>,
a vector space where weighted averages are well defined. The gradient is
recognized to be</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>∇</mi><mi>J</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>λ</mi><mi>i</mi></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla J(w) = - \sum_i \lambda_i \log[r_i]</annotation></semantics></math></p>
<p>To perform a gradient descent iteration, we need to properly
generalize the operation of (small) displacement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>↦</mo><mi>w</mi><mo>−</mo><mi>∇</mi><mi>J</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w \mapsto w -\nabla J(w)</annotation></semantics></math>.
We understand we really need to transform
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
by the exponential of the tangent vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∇</mi><mi>J</mi></mrow><annotation encoding="application/x-tex">-\nabla J</annotation></semantics></math>.
We define the “exponential” to invert the “logarithm”:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>v</mi><mo stretchy="true" form="postfix">|</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><mi>ϕ</mi></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mo>tanh</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mo stretchy="true" form="prefix">|</mo><mi>v</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><mi>ϕ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\exp[|v|e^{i\phi}] = \tanh\left(\frac{|v|}{2}\right)e^{i\phi}</annotation></semantics></math></p>
<p>And finally the iteration step is as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>↦</mo><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mi>∇</mi><mi>J</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>w</mi></mrow><annotation encoding="application/x-tex">w \mapsto M(\exp[-\nabla J(w)]) \cdot w</annotation></semantics></math></p>
<p>We employ the following algorithm with linear convergence, described
directly in the Poincaré disk for convenience:</p>
<ul>
<li>Set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
to a first guess,
e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum_i \lambda_i w_i</annotation></semantics></math>.</li>
<li>Start loop:</li>
<li><ul>
<li>Find vertices relative to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>=</mo><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i = M(-w)\cdot w_i</annotation></semantics></math>.</li>
</ul></li>
<li><ul>
<li>Compute gradient as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>∇</mi><mi>J</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>λ</mi><mi>i</mi></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla J(w) = - \sum_i \lambda_i \log[r_i]</annotation></semantics></math></li>
</ul></li>
<li><ul>
<li>Compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mi>∇</mi><mi>J</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">u = \exp[-\nabla J]</annotation></semantics></math>.
This is the next step position, but relative to current
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>.</li>
</ul></li>
<li><ul>
<li>Translate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
through
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>↦</mo><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w \mapsto M(u) w</annotation></semantics></math></li>
</ul></li>
<li><ul>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>u</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>&lt;</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">|u|&lt;\epsilon</annotation></semantics></math>,
break and return
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">¯</mo></mover><annotation encoding="application/x-tex">\overline w</annotation></semantics></math>.</li>
</ul></li>
</ul>
<h1 id="color-harmony">Color Harmony</h1>
<h2 id="complementarity-and-skin-frame">Complementarity and Skin
Frame</h2>
<p>Complementary colors is one of the most inconsistent and
contradictory topics in color theory. This is inclusive both of the
meaning, purpose and effect of complementary colors, and specifically of
which colors should be complementary with which.</p>
<p>I argue that this is in fact a manifestation of the notion of
complementarity being relative; this relativity fortuitously happens to
be in fact mathematically identical to special relativity in physics,
since the Lorentz group is the isometry group of the hyperbolic plane.
We speak of complementarity only with respect to a center, or
whitepoint, which in turn defines a <strong>reference frame</strong>.
Complementarity in one frame is distinct from that in another.</p>
<p>First of all, complementarity involves exclusively the chroma
component, and it is independent from the luma.</p>
<p>Two chromaticities are complementary in a given frame if the
(hyperbolic) straight segment between them passes through the center.
Equivalently, we can define <strong>hue</strong> as the angle from the
center, assuming the thermal axis from the center to the ideal warm
point as 0°, and then complementary colours have hues 180° apart. Hue is
frame dependent.</p>
<p>The D65 whitepoint, the “true” grey, defines a frame which is related
the physiology of human vision. Complementaries in this frame are
opponents of the opponent process theory. Afterimages of a certain color
are in its opponent complementary, for example in this well-known
illusion:</p>
<p><img src="assets/opponent_illusion.gif" /></p>
<p>Staring at the cross for enough time makes a green dot appear in the
moving vacancy - this is because green is the opponent complementary to
magenta, <em>because</em> they are collinear with the grey of the
background.</p>
<p>However, for art the opponent pairs are less useful. There is a
notion of complementarity, which we will call <strong>harmonic
complementarity</strong>, in which complementary colors are those that
clash and are perceived to be in a messy and repulsive relationship.
Harmonic complementaries are unclear in their intent, displeasing, and
have a characteristic sickly shimmer on their boundary. This impression
is worse at higher saturation, but it is in fact always present.</p>
<p>The prototypical clashing pair is red and green:
<i class="ctile-13"></i> <i class="ctile-6"></i>. Note that this is
different from the D65 frame, since the opponent complementary of red is
cyan, and for green is, as seen, magenta.</p>
<p>I have performed an experiment and acquired data to precisely
determine which pairs of colors are harmonic complementaries. If we draw
the segments between them, they <em>roughly</em> appear to be passing
through a single point:</p>
<p><img src="assets/complementarity_data.png" /></p>
<p>This harmonic center, which I’ve fixed at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>0.25</mn><mo>+</mo><mn>0.1</mn><mi>i</mi></mrow><annotation encoding="application/x-tex">w=0.25 + 0.1i</annotation></semantics></math>
is a decidedly orange-ish chromaticity which happens to be, roughly,
that of human skin (of various ethnicities). It looks like this at
various lumas</p>
<p><img src="assets/skincenter.png" /></p>
<p>The significance of a match with skin tones is probably a rabbit hole
best left for spare afternoons. Still, we can term this the skin center,
defining a <strong>skin frame</strong>. For some reason, harmony is
relative to the skin frame. After transforming (“boosting”) to the skin
frame, the definition of hues and their spacing is completely different
from D65. These new, harmonic hues shrink the space dedicated to cool
colors and expand the accuracy on warm hues, due to the inherently warm
bias of the whitepoint.</p>
<p>In the skin frame, D65 itself is not neutral anymore, and it is
perceived to have a <strong>blue</strong> hue, with mild saturation.
This means that, as such, it really is harmonic complementary to orange,
and this is true at all luma. We can therefore conclude, somewhat
humorously but with reasonable motivation, that <strong>white is
complementary to orange</strong>, and they will indeed clash if the
alignment is correct.</p>
<p>Here is the geodesic gradient between two (harmonic) complementaries:
as expected, the gradient passes through the skin center, and
consequently, the pairing is unpleasant in character.</p>
<p><img src="assets/geograd_comp.png" /></p>
<p>In a way, complementary pairs “cancel out” and blend into nothing,
assuming we understand human skin as a default non-statement.</p>
<p>Instead, if we shift one of the colors slightly, the geodesic segment
misses the skin center and the pairing improves considerably in appeal,
as their geodesic blend acquires a very slight greenish-yellowish tint
from skin tone:</p>
<p><img src="assets/geograd_reso.png" /></p>
<p>We will see shortly that such “near misses” are indeed what we should
strategically target to employ colors in an aesthetically pleasing
manner.</p>
<h2 id="tone-system">14-tone system</h2>
<p>The division of the color wheel in the skin frame into a certain
number of equal spokes is completely arbitrary, and arguably unnecessary
since the geometric picture is available; nevertheless, having a
discrete structure will greatly improve practical use, even if there is
a small loss of generality. So far, the best choice I’ve found is to
divide hues into <strong>14 equal steps</strong>.</p>
<p>For the skin frame hues in the 14-tone system I’ve chosen the
following naming convention, using lowercase latin letters to avoid
confusion with pre-existing systems:</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="odd">
<td><i class="ctile-0">v</i></td>
<td>Vermillion</td>
<td>Warm, orange-ish red</td>
</tr>
<tr class="even">
<td><i class="ctile-1">c</i></td>
<td>Carrot</td>
<td>Reddish orange</td>
</tr>
<tr class="odd">
<td><i class="ctile-2">o</i></td>
<td>Orange</td>
<td>Orange fruit, cold orange</td>
</tr>
<tr class="even">
<td><i class="ctile-3">h</i></td>
<td>Honey</td>
<td>Warm, orange-ish yellow, gold</td>
</tr>
<tr class="odd">
<td><i class="ctile-4">y</i></td>
<td>Yellow</td>
<td>Lemon, cold yellow</td>
</tr>
<tr class="even">
<td><i class="ctile-5">x</i></td>
<td>Chartreuse</td>
<td>Pear, yellow-green</td>
</tr>
<tr class="odd">
<td><i class="ctile-6">g</i></td>
<td>Green</td>
<td>Slightly cold green, forest green</td>
</tr>
<tr class="even">
<td><i class="ctile-7">t</i></td>
<td>Teal</td>
<td>Bluish green, aquamarine, turquoise</td>
</tr>
<tr class="odd">
<td><i class="ctile-8">n</i></td>
<td>Noon</td>
<td>Noon sky, greenish blue</td>
</tr>
<tr class="even">
<td><i class="ctile-9">b</i></td>
<td>Blue</td>
<td>Late afternoon sky, sea blue</td>
</tr>
<tr class="odd">
<td><i class="ctile-10">l</i></td>
<td>Lavender</td>
<td>Bluish violet, dark intense blues, cobalt blue, sRGB primary
blue</td>
</tr>
<tr class="even">
<td><i class="ctile-11">m</i></td>
<td>Magenta</td>
<td>Cold pinks</td>
</tr>
<tr class="odd">
<td><i class="ctile-12">p</i></td>
<td>Pink</td>
<td>Bordeaux, warm pinks, violet-ish red, burgundy</td>
</tr>
<tr class="even">
<td><i class="ctile-13">r</i></td>
<td>Red</td>
<td>Blood red</td>
</tr>
</tbody>
</table>
<p>The diagram below depicts the extents of the sRGB gamut in the skin
frame with marked hue spokes, and the max-saturation colors of each hue.
(For this guide we will use more subdued representative tones since the
wild fluctuations in luma and saturation on the gamut boundary can be
confusing). Also marked, with greek letters, the RGB primaries and
secundaries, displaying misalignment with the new categories (e.g.,
primary red is decidedly warm).</p>
<p><img src="assets/skinframe_gamut.png" /></p>
<p>Observe that D65 greys, including full black and full white, are
exactly halfway between n and b, meaning their complementary axis is as
far as possible from o and c. This is convenient for digital art as it
allows the use of full black and white while minimizing the risk of
clashing with intermediate tones, if o and c are preferred.</p>
<h3 id="categorical-warp">Categorical Warp</h3>
<p><img src="assets/toneslices.png" /></p>
<p>Categorical warp is a subtle but important effect in the skin frame
which rests on the mismatch between literal, semantic color categories
and hue-saturation as defined in a particular frame. It is important for
an artist to be able to see colors in terms of their harmonic,
<em>functional</em> properties, instead.</p>
<p>Semantic categories, which are usually defined in term of opponent
process theory (i.e. blue <em>against</em> yellow, etc), break down when
the saturation is lowered, as they get “warped” by the shifted reference
frame in which we’re working. The categorical warp is maximum for the
pink-chartreuse axis, so let’s imagine as an example that one wants to
produce a desaturated yellow-green.</p>
<p>Instict would dictate one attempts to find a shade of greenish and
slightly yellowish grey that would be categorized, in common parlance,
as “chartreuse, but less intense”. This is however incorrect in a
functional sense, as the less intense color of the same hue as intense
chartreuse is in fact much more yellow-orange. Since our perception
adapts extremely well to the skin background, the effect is almost
invisible in the diagram above, but actually picking the coloured tiles
will reveal the very significant mismatch.</p>
<p>A slightly different, but related form of categorical mismatch occurs
with primary blue (β),which is sharply located in the lavender (l) hues
in the skin frame, but appears to be distinctly more blue than that,
almost blue-violet. This is entirely due to categorical warp according
to primary blue’s excessive saturation compared to neighbouring lavender
tones; functionally, it will still act like a lavender.</p>
<h2 id="tone-intervals">14-Tone Intervals</h2>
<p>Harmonic coloring is based on two principles:</p>
<ol type="1">
<li>Complementary tones are maximally dissonant and should always be
avoided.</li>
<li>Contrast should be employed optimally to establish importance of
elements.</li>
</ol>
<p>These are forces in opposition: clearly complementary colors have the
greatest contrast, yet the best choice for a dichromatic piece is an
interval which is as large as possible without being dissonant. Since
complementaries are separated by 7 steps, this optimal choice is a
6-step interval we call a <strong>resonant</strong>. Every tone has two
resonants going clockwise or counter-clockwise. This is the 14 tones
connected by resonance; since 6 is even (and so is 14), resonances have
the same parity, thus there is an even cycle of resonants
<strong>voygnlp</strong> and an odd cycle <strong>chxtbmr</strong>,
analogous to the circle of fifths in music.</p>
<p><img src="assets/star.png" /></p>
<p>Working only with resonants is quite boring and static; some
variation in relationship between the hues can expand the emotional
range of a piece. While the contrast is lesser, an interval of 5 steps
is also quite pleasant, and it could be called a
<strong>semi-resonant</strong>. Here is all the possible intervals,
sorted by increasing dissonance, with my interpretation:</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th>N</th>
<th>Interval</th>
<th>Quality</th>
<th>Left</th>
<th>Right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Unison</td>
<td>Complex (see below)</td>
<td><i class="ctile-13"></i> <i class="ctile-13"></i></td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td>Resonant</td>
<td>Mutual emphasis: maximum contrast without complementarity</td>
<td><i class="ctile-13"></i> <i class="ctile-5"></i></td>
<td><i class="ctile-13"></i> <i class="ctile-7"></i></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Semi-resonant</td>
<td>Similar to resonant, but with lesser contrast</td>
<td><i class="ctile-13"></i> <i class="ctile-4"></i></td>
<td><i class="ctile-13"></i> <i class="ctile-8"></i></td>
</tr>
<tr class="even">
<td>3</td>
<td>Adjoint</td>
<td>Adjoint tones work together towards the same goal</td>
<td><i class="ctile-13"></i> <i class="ctile-2"></i></td>
<td><i class="ctile-13"></i> <i class="ctile-10"></i></td>
</tr>
<tr class="odd">
<td>2</td>
<td>Major Analogous</td>
<td>Slightly dissonant: complementary of semi-resonant</td>
<td><i class="ctile-13"></i> <i class="ctile-1"></i></td>
<td><i class="ctile-13"></i> <i class="ctile-11"></i></td>
</tr>
<tr class="even">
<td>4</td>
<td>Mediant</td>
<td>Odd and disorienting</td>
<td><i class="ctile-13"></i> <i class="ctile-3"></i></td>
<td><i class="ctile-13"></i> <i class="ctile-9"></i></td>
</tr>
<tr class="odd">
<td>1</td>
<td>Minor Analogous</td>
<td>Dissonant: complementary of resonant</td>
<td><i class="ctile-13"></i> <i class="ctile-0"></i></td>
<td><i class="ctile-13"></i> <i class="ctile-12"></i></td>
</tr>
<tr class="even">
<td>7</td>
<td>Complementary</td>
<td>Highly displeasing</td>
<td><i class="ctile-13"></i> <i class="ctile-6"></i></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="axial-complementarity">Axial complementarity</h3>
<p><em>wip</em></p>
<h2 id="triads">Triads</h2>
<p>The simplest non-trivial palette structure is the triangular field
between three vertices, one of which is marked as the
<strong>key</strong>, and the other two for the <strong>base</strong>.
The key is the chromatic focal point of the piece and the purpose of the
triad is to emphasize the key by establishing a context in which it is
intensified by contrast.</p>
<p>The triad should be thought of as an arrow pointing to the key, it is
inherently a directed and dynamical structure. The motion is from base
to key, but also background to foreground, general to specific, and it
is the physical guided motion of the eye as it absorbs the piece.</p>
<p>A triad can certainly not have any complementaries among its
vertices. In addition, it should envelop the harmonic center, so the
base vertices should be on opposite sides of the complementary to the
key. Finally, since the key should be emphasized, the interval of the
base must be smaller than those from the base to the key. This only
leaves four possibilities:</p>
<p><img src="assets/triads.png" /></p>
<p>The key is positioned on the right, and I have further marked tones
that have been excluded due to complementarity.</p>
<p>The <strong>ultra-narrow</strong> triad is functional but has
undesirable properties: the base is dissonant and the range is small.
This palette is difficult to extend as further fields quickly drown out
the main one. In addition, the symmetry with respect to the key axis
makes it rather static.</p>
<p>The <strong>narrow</strong> triads are similar, but not identical, to
Fletcher’s. They are asymmetric and come in two chiral forms. The
intervals are varied and harmonious: a resonant, a semi-resonant, and an
adjoint. These palettes exhalt the key efficiently while also
incorporating a great degree of playful secondary motion. They provide
the range for rather surprising and dynamic artwork, and have the
greater potential to be extended. Generally narrow triads are the most
promising choice for main fields.</p>
<p><strong>Wide</strong> triads are unweildy. The primality of the key
is extremely weak (in fact, in the 12 tone system these are equilateral
triangles), the base interval is a mediant which is generally unpleasant
or uncertain in character, and finally there is symmetry. The range is
vast, but this is potentially at the detriment of the piece.</p>
<h3 id="tonnetz">Tonnetz</h3>
<p>Given what we know about harmony so far, the abstract color wheel
with analogous tones adjacent is not a particularly convenient
representation. We can lift a page from music theory again and construct
a two-dimensional lattice (tonnetz) where each edge represents a
particular consonant interval:</p>
<p><img src="assets/lattice.png" /></p>
<p>A portion of a Neo-Riemannian style lattice for the 14-tone system.
The lattice is periodic. Dotted lines represent adjoints, solid line are
resonants, and dashed lines are semi-resonants. Every triangle is a
narrow triad, and each tone is the key for the triads directly above and
below it.</p>
<p>For example, y is the bottom vertex of the narrow triad y/b/p, with y
as the key, p as the base resonant, and b as the semi-resonant. However,
it shares an edge with the narrow triad p/y/t, with now p as the key, y
as the base resonant, and t as the semi-resonant. Joined together, the
two triads assemble in a four-tone object including y,b,p and t, and
with the new interval b-t which is a major analogous.</p>
<p>The tonnetz also places at maximum distance colors which are
complementaries or mediants, providing a further rationalization of why
they’re perceived as displeasing – they are “distant” in terms of the
number of resonant steps that must be taken to bring one to the other.
In this picture (which is to be understood as more poetic than literal),
r and g are offending to the eye because the eye is invited to imagine,
for example, that the relationship of g to r is that g is resonant to p,
which is semi-resonant to t, which is resonant to r, but also the
inverted path r -&gt; x -&gt; v -&gt; g. The complexity and ambiguity of
the relationship is too much for intuitive comprehension, which
contrasts with the immediacy, for example, of the resonance between r
and t.</p>
<p>The tonnetz is actually a finite structure, periodic in two
directions. It is in fact a torus, tessellated into 28 triangles (the
narrow triads) and with the 14 tones as vertices. It can be in fact
visualized as a geometric torus:</p>
<p><img src="assets/tonnetz_torus.png" /></p>
<p>Or see also <a
href="https://cancrizans.github.io/hycol_tool/torus">as an interactive
3d model</a>.</p>
<h3 id="value">Value</h3>
<p><em>wip</em></p>
<h3 id="triadic-painting">Triadic Painting</h3>
<p>Here’s a rough practical tutorial on how to lay out a palette for a
simple piece in a single narrow triad.</p>
<p>Open the HYCOL tool <a
href="https://cancrizans.github.io/hycol_tool/">here</a>. Disable all
displays except for the hue wheel, and ensure the number of hue
divisions is set at 14. Select the SKN whitepoint to center the view on
the skin tone.</p>
<p>We now select a key tone; honey is a good choice. There are two
possible triads with h as the key: h/b/p and h/m/n (we can see this from
the tonnetz or directly from the color wheel). Let’s go with h/b/p. The
resonant is blue, which we remind is a vaguely purplish, late-afternoon
sky class of blues, while the semi-resonant pink is
bordeauxs/violet-reds/burgundies.</p>
<p>Going back to the interface, we add poles until we have three, then
we start color picking them. Looking at the 3d view from above, I line
up the colors with the corresponding hue lines:</p>
<p><img src="assets/tooltut_0.png" /></p>
<p>I’ve chosen very saturated tones for all three, and a rich dark
burgundy for pink (if it seems strange, remember categorical shift!).
The saturations and values are up to you; harmony only depends on the
correct alignment in hue. However, you should try to avoid too
desaturated tones, or very low separation in values. I check the values
by rotating into side view, and choosing display value levels:</p>
<p><img src="assets/tooltut_1.png" /></p>
<p>The value range is decent for a soft piece. (If we want to use darker
values, we might want to add a scotopic tail, but for now we’ll keep it
simple.) In this case, the key is the lightest pole, which is usually
pretty easy to work with, but it’s not mandatory. The key will be
emphasized nevertheless by the harmonic information.</p>
<p>In the tool, I create a field, and select poles 0, 1, 2. The
following palette is produced by geodesic interpolation of the three
poles:</p>
<p><img src="assets/tooltut_2.png" /></p>
<p>Of course, I can still modify the poles and the field will be updated
accordingly. Now as a first approximation, I can basically use any color
from this triangle anywhere in the piece and it should look ok, but a
better result can be obtained by employing the structure
<em>functionally</em>. The first note I would make is to mark out the
rough region of colors, shaded in red, that are close enough to the
complementarity axis of the key to be potentially muddy. This region of
the triad is not forbidden, but you want to resist the temptation to
linger too much on it if barely. For example, when interpolating from
the burgundy to the blue pole, you might wanna “speed up” halfway
through to skip the dissonant peak.</p>
<p><img src="assets/tooltut_3.png" /></p>
<p>In general, you want to bias your palette use towards the edges of
the field. In addition, you can divide your image into “background”
(context) and “foreground” (subject), and for the background only use
the base from burgundy to blue, without mixing in the key. For the
foreground you deploy the key, but you can use the entire palette
really, interleaving colors from the three ramps (and from inside the
field as well) to create an interesting and multidimensional
texture.</p>
<p>Note that this automatically gives us a value range hierarchy between
background and foreground, since the former is limited in the range of
values between the p and b poles, while the latter can go all the way
from p to h (the fact that the geodesic interpolation is interpolating
the luma at the same rate as the chroma is what guarantees this).</p>
<h2 id="polytriadic-structure">Polytriadic Structure</h2>
<p><em>wip</em></p>
<h2 id="combinatoric-modes-and-non-functional-approach">Combinatoric
Modes and Non-functional Approach</h2>
<p>As an alternative to working with triads, there is potential for an
eclectic and simpler color picking system in which tones are selected
exclusively to avoid dissonance but with no semantic intentionality.
This coloring style is potentially well suited for comics and
illustration, and it provides large and rich non-offending palettes,
though color does tend to be employed in a more literal sense, losing
its emotional charge.</p>
<p>This, in my opinion, mirrors non-functional harmony in music: colors
do not have a color-theoretic function, but are simply meaningless
expressive units that the artist can assemble freely.</p>
<p>In a non-functional palette, blending fields should be avoided
altogether, preferring instead to pick colors from a discrete set of
hues, in turn chosen to prevent dissonance. Generally, one chooses from
the set the hue that best approximates the intended color (typically
literal: trees are green, sky is blue etc.).</p>
<p>The 14-tone system allows a maximum of 7 colors without
complementaries amongst themselves. There is a total of 128 of these
maximal sets, but up to rotations there are only 10 distinct
possibilities, which we term combinatoric modes:</p>
<p><img src="assets/combinatoric_modes.png" /></p>
<p>Note that modes I and II are chiral and are mirror images of
eachother, all other modes are symmetric with respect to an axis. Mode
VIII is simply the resonant cycle of a given parity, as seen before.</p>
<p>Mode III and VII might be excluded on the ground of being severely
unbalanced.</p>
<p>Past that, the choice of mode is informed primarily by which
secondary dissonance, after complementaries, is deemed more problematic:
the minor analogous or the mediant. Mode VIII for example has no minor
analogies but many mediants. Mode X is particularly nice, with only two
minor analogies and only one mediant.</p>
<p>Let’s try to build a palette in mode X just as an example. Let’s say
that the point in the bottom left through the axis of symmetry is
<i class='ctile-10'>l</i> - we rotate the mode X schema over the color
wheel and then pick hues accordingly: going counter-clockwise, after l
we skip two places, then pick r, then skip one place, then pick o, and
so on, to obtain:</p>
<p><i class='ctile-10'>l</i> <i class='ctile-13'>r</i>
<i class='ctile-1'>c</i> <i class='ctile-2'>o</i>
<i class='ctile-4'>y</i> <i class='ctile-5'>x</i>
<i class='ctile-7'>t</i></p>
<p>This palette is “safe to pick”, with the right caveats:</p>
<ul>
<li>Low-saturation (with saturation as in the skin frame!) colors should
be limited, as is having too many colors for the same tone.</li>
<li>The use of the tones should be “atonal” in the sense that the artist
should strive specifically to avoid explicit functional relationships
that might undermine the intention of the piece. We do not want to
accidentally be using any tone as a triadic key, for example.</li>
</ul>
<h1 id="appendix">Appendix</h1>
<h2 id="models-of-the-hyperbolic-plane">Models of the Hyperbolic
plane</h2>
<h3 id="poincaré-disk">Poincaré Disk</h3>
<p>Parametrized by complex
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
in the unit disk
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|w|&lt;1</annotation></semantics></math>.
This is a conformal model. The conformal boundary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|w|=1</annotation></semantics></math>
is composed of all ideal points.</p>
<p>The representation of geometric objects are as such: - Lines:
generalized circular arcs which meet the boundary at right angles. -
Circles: Euclidean circles contained entirely within the disk. -
Horocycles: Euclidean circles tangent to the boundary. - Hypercycles:
generalized circular arcs that meet the boundary at non-right
angles.</p>
<p>Angles are accurately represented.</p>
<p>The metric is</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msup><mi>s</mi><mn>2</mn></msup><mo>=</mo><mfrac><mrow><mn>4</mn><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>d</mi><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">ds^2 = \frac{4|dw|^2}{(1-|w|^2)^2}</annotation></semantics></math></p>
<p>Isometries are given by Moebius transformations in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>S</mi><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PSU(1,1)</annotation></semantics></math>,
so of the form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>u</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>v</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mover><mi>v</mi><mo accent="true">¯</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mover><mi>u</mi><mo accent="true">¯</mo></mover></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix} u &amp; v \\ \overline{v} &amp; \overline{u} \end{bmatrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>u</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>v</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|u|^2-|v|^2 = 1</annotation></semantics></math>.
This is actually a double cover, so it’s necessary to quotient by the
centre
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{-1,1\}</annotation></semantics></math>.
It can equivalently be described as the unit split-quaternion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mi>u</mi><mo>+</mo><mi>v</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">q = u + v j</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>i</mi><mn>2</mn></msup><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i^2 = -1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>j</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j^2=1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>j</mi><mo>=</mo><mo>−</mo><mi>j</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">ij = -ji</annotation></semantics></math>,
and the split-quaternion norm is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>u</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>v</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N(q) = |u|^2-|v|^2</annotation></semantics></math>.</p>
<h3 id="poincaré-half-plane">Poincaré Half-Plane</h3>
<p>Parametrized by complex
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">z = x+iy</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>ℑ</mi><mi>z</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y = \Im{z} &gt; 0</annotation></semantics></math>.
This is a conformal model. The conformal boundary is given by the real
axis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℑ</mi><mi>z</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Im{z} = 0</annotation></semantics></math>
compactified with the one point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">z=\infty</annotation></semantics></math>.</p>
<p>The representation of geometric objects are as such: - Lines:
generalized circular arcs which meet the boundary at right angles.
(Including vertical lines which are understood to meet
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">z=\infty</annotation></semantics></math>
at 90°) - Circles: Euclidean circles contained entirely within the disk.
- Horocycles: Euclidean circles tangent to the boundary. (Including
horizontal lines) - Hypercycles: generalized circular arcs that meet the
boundary at non-right angles. (Including any lines not horizontal nor
vertical)</p>
<p>The metric is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msup><mi>s</mi><mn>2</mn></msup><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>d</mi><mi>z</mi><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ℑ</mi><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>=</mo><mfrac><mrow><mi>d</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi><msup><mi>y</mi><mn>2</mn></msup></mrow><msup><mi>y</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">ds^2 = \frac{|dz|^2}{(\Im z)^2} = \frac{dx^2+dy^2}{y^2}</annotation></semantics></math></p>
<p>Isometries are given by real Moebius transformations in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>S</mi><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mi>ℝ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PSL(2,\mathbb{R})</annotation></semantics></math>,
so of the form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>a</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>b</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>c</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>d</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix} a &amp; b \\ c &amp; d \end{bmatrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">a,b,c,d</annotation></semantics></math>
are real and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>d</mi><mo>−</mo><mi>b</mi><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">ad-bc=1</annotation></semantics></math>,
again with quotient of the overall sign.</p>
<h3 id="conversions">Conversions</h3>
<h4 id="equidistand-azimuthal-and-poincaré-disk">Equidistand Azimuthal
and Poincaré Disk</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>2</mn><msup><mo>tanh</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">\rho = 2 \tanh^{-1}|w|</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mo>tanh</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ρ</mi><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><mi>θ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">w = \tanh(\rho/2) e^{i\theta}</annotation></semantics></math></p>
<h4 id="poincaré-disk-and-half-plane">Poincaré Disk and Half-Plane</h4>
<p>Also known as the Riemann Sphere’s Cayley transform.</p>
<p>This is assuming the convention of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>1</mn><mo>→</mo><mi>z</mi><mo>=</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">w = 1 \rightarrow z = \infty</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo>→</mo><mi>z</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w = -1 \rightarrow z = 0</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mo>−</mo><mi>i</mi><mfrac><mrow><mi>w</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex"> z = -i \frac{w+1}{w-1} </annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mi>i</mi></mrow><mrow><mi>z</mi><mo>+</mo><mi>i</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">w = \frac{z-i}{z+i}</annotation></semantics></math></p>
</body>
</html>
